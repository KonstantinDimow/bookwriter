<%= stylesheet_link_tag "versions" %>

<h2>Versionsübersicht: <%= @book.title %> / <%= @chunk.title %></h2>

<%= form_tag(compare_book_chunk_version_path, method: :post) do %>
<table class="table table-striped">
  <tr>
    <th></th>
    <th>Version</th>
    <th>Inhalt</th>
    <th>Benutzer</th>
    <th>Erstellt am</th>
    <th></th>
    <th></th>
  </tr>

  <tr>
    <td>
      <%= check_box_tag 'vers' + 0.to_s, '0', false, {:onclick => 'setChoice(%s)' % 0} %>
    </td>
    <td>Aktuell</td>
    <td>
      <%= raw(@chunk.content[0..@content_size]) %>
    </td>
    <td><%= User.find(@chunk.user_id).username %></td>
    <td><%= @chunk.created_at.strftime("%d.%m.%Y %H:%M:%S")  %></td>
    <td></td>
    <td><%= button_to 'hallo','', :style => 'display:none' %>
      <%= button_to 'Ansehen',book_chunk_version_version_path(@book,@chunk,0), method: :get,:class => 'btn btn-default btn-xs'  %></td>
  </tr>

  <% @entries.times do |i| vers = @chunk.versions[@chunk.versions.last.index - i]%>
    <% unless vers.index == 0 %>
      <tr>
        <td>
          <%= check_box_tag 'vers' + vers.index.to_s, vers.index, false, {:onclick => 'setChoice(%s)' % vers.index} %>
        </td>
        <td><%= vers.index %></td>
        <td><%= raw (vers.reify.content[0..@content_size]) %></td>
        <td><%= User.find(vers.whodunnit).username %></td>
        <td><%= vers.created_at.strftime("%d.%m.%Y %H:%M:%S")  %></td>
        <td><%= button_to 'Zurücksetzen', @chunk.book_id.to_s << @chunk.id.to_s << '/revert/' << vers.index.to_s , method: :post,:class => 'btn btn-default btn-xs' %></td>
        <td><%= button_to 'Ansehen',book_chunk_version_version_path(@book,@chunk,vers.id), method: :get,:class => 'btn btn-default btn-xs'  %></td>
      </tr>
      <% end %>
  <% end %>
  <tr>
    <td colspan="7">
      <div id="selectEntryAmount">
        <%=link_to '10', {:controller => 'versions', :action => 'show', :entries => '10'}%> |
        <%=link_to '25', {:controller => 'versions', :action => 'show', :entries => '25'}%> |
        <%=link_to '50', {:controller => 'versions', :action => 'show', :entries => '50'}%> |
        <%=link_to 'All', {:controller => 'versions', :action => 'show', :entries => '-1'}%>
      </div>
    </td>
  </tr>

</table>
    <div class="submitbutton">
        <%= submit_tag 'Vergleichen' ,:id => 'compare', :disabled => 'true', :class => 'btn btn-default'%>
    </div>
<% end %>

<%= button_to 'Zurück', book_url(@chunk.book_id) , method: :get, :class => 'btn btn-default backbutton'%>